# 後台管理系統使用指南

## 📋 系統概述

這是一個用於管理八天旅遊行程的後台系統，您可以通過網頁界面輕鬆編輯每一天的行程內容。

---

## 🔐 登入資訊

### 管理後台入口
- **URL**: http://localhost:3000/login.html
- **預設帳號**: `admin`
- **預設密碼**: `password123`

### 安全性說明
- 登入狀態保存在瀏覽器的 sessionStorage 中
- 關閉瀏覽器分頁後會自動登出
- 離開管理後台頁面後需要重新登入

---

## 🚀 啟動步驟

### 1. 啟動伺服器
```bash
cd c:\Users\NEO\travel-website
node server.js
```

您應該會看到：
```
Server is running on http://localhost:3000
Admin Panel: http://localhost:3000/admin.html
```

### 🛑 關閉伺服器

#### 方法 1：正常關閉（推薦）
如果需要停止伺服器：
- 在運行伺服器的終端機視窗中按 **`Ctrl + C`**
- 或直接關閉終端機視窗

#### 方法 2：強制關閉（當 Ctrl+C 無效時）
如果找不到終端機視窗或 `Ctrl + C` 無效：

```bash
# 1. 查找佔用 3000 端口的進程
netstat -ano | findstr :3000

# 2. 終止該進程（將 PID 替換為上一步顯示的進程 ID）
taskkill /PID 進程ID /F
```

**完整範例**：
```bash
# 查找進程
netstat -ano | findstr :3000
# 輸出：TCP    0.0.0.0:3000    0.0.0.0:0    LISTENING    9548

# 終止進程（9548 是範例，請使用實際的 PID）
taskkill /PID 9548 /F
```

### 🔄 重新啟動伺服器
修改 `server.js` 或 `data/users.json` 後需要重啟：
1. 按 `Ctrl + C` 停止伺服器
2. 執行 `node server.js` 重新啟動

### 2. 登入系統
1. 打開瀏覽器，前往 http://localhost:3000/login.html
2. 輸入帳號：`admin`
3. 輸入密碼：`password123`
4. 點擊「登入」

### 3. 進入管理後台
登入成功後會自動跳轉到管理後台 http://localhost:3000/admin.html

---

## 📝 如何編輯行程

### 編輯流程

1. **選擇要編輯的日期**
   - 點擊對應的「編輯」按鈕

2. **彈出編輯表單**
   - **標題**：例如「抵達東京 | 淺草寺初訪」
   - **描述**：簡短描述，例如「淺草寺感受傳統文化，晚上體驗新宿繁華夜景」
   - **詳細行程**：完整的行程安排，可以包含多行文字

3. **保存變更**
   - 點擊「保存」按鈕
   - 系統會顯示「保存成功！」的提示

4. **取消編輯**
   - 如果不想保存變更，點擊「取消」按鈕

### 編輯範例

**Day 1: 抵達東京 | 淺草寺初訪**

標題：
```
抵達東京 | 淺草寺初訪
```

描述：
```
淺草寺感受傳統文化，晚上體驗新宿繁華夜景
```

詳細行程：
```
上午：抵達成田機場，搭乘 Skyliner 前往市區
中午：在淺草享用傳統日式料理
下午：參觀淺草寺和雷門，逛仲見世商店街
傍晚：前往晴空塔觀景台欣賞東京夜景
晚上：新宿歌舞伎町體驗繁華夜生活
```

---

## 🔄 查看變更

### 方法 1：在管理後台查看
編輯並保存後，管理後台會立即顯示更新後的內容。

### 方法 2：在主網站查看
1. 點擊「登出並返回首頁」按鈕
2. 或直接訪問 http://localhost:3000/index.html
3. 捲動到行程區域，點擊對應的日期卡片
4. 展開後可以看到更新後的詳細行程

---

## 🔧 修改登入資訊

如果您想修改管理員帳號或密碼：

### 1. 編輯 users.json
打開 `c:\Users\NEO\travel-website\data\users.json`

```json
[
    {
        "username": "admin",
        "password": "password123"
    }
]
```

### 2. 修改帳號密碼
```json
[
    {
        "username": "您的新帳號",
        "password": "您的新密碼"
    }
]
```

### 3. 保存並重啟伺服器
- 按 `Ctrl + C` 停止伺服器
- 執行 `node server.js` 重新啟動

---

## 📂 數據存儲位置

### 行程數據
- **文件路徑**: `c:\Users\NEO\travel-website\data\itinerary.json`
- **格式**: JSON
- **備份建議**: 編輯前先備份這個文件

### 數據結構範例
```json
{
    "days": [
        {
            "day": 1,
            "title": "抵達東京 | 淺草寺初訪",
            "description": "淺草寺感受傳統文化，晚上體驗新宿繁華夜景",
            "details": "上午：抵達成田機場..."
        }
    ]
}
```

---

## ⚠️ 注意事項

### 1. 伺服器必須運行
- 編輯行程前，確保伺服器正在運行
- 如果看到「無法連接」錯誤，檢查伺服器是否啟動

### 2. 數據會立即保存
- 點擊「保存」後，變更會立即寫入 `itinerary.json`
- 無法撤銷，請謹慎編輯

### 3. 登出機制
- 點擊「登出並返回首頁」會清除登入狀態
- 關閉瀏覽器分頁也會清除登入狀態
- 下次訪問管理後台需要重新登入

### 4. 瀏覽器兼容性
- 建議使用 Chrome、Edge 或 Firefox
- 確保瀏覽器允許 sessionStorage

---

## 🛠️ 常見問題

### Q1: 登入後自動跳轉回登入頁
**原因**：瀏覽器可能阻止了 sessionStorage

**解決方法**：
- 檢查瀏覽器的隱私設置
- 允許網站使用本地存儲

### Q2: 保存後沒有看到變更
**原因**：瀏覽器緩存了舊數據

**解決方法**：
- 按 `Ctrl + F5` 強制刷新頁面
- 或按 `F12` 打開開發者工具，右鍵點擊刷新按鈕，選擇「清空緩存並硬性重新載入」

### Q3: 編輯後出現「系統錯誤」
**原因**：可能是網絡問題或伺服器錯誤

**解決方法**：
1. 檢查伺服器是否正在運行
2. 查看伺服器終端機的錯誤訊息
3. 確認 `data/itinerary.json` 文件存在且格式正確

### Q4: 忘記密碼怎麼辦
**解決方法**：
1. 打開 `data/users.json`
2. 直接修改密碼
3. 重啟伺服器

---

## 📊 API 端點說明

後台使用以下 API 與伺服器通訊：

### 登入
- **端點**: `POST /api/login`
- **請求體**: `{ "username": "admin", "password": "password123" }`
- **回應**: `{ "success": true }`

### 獲取行程
- **端點**: `GET /api/itinerary`
- **回應**: 完整的行程 JSON 數據

### 更新行程
- **端點**: `POST /api/itinerary`
- **請求體**: 完整的行程 JSON 數據
- **回應**: `{ "success": true }`

---

## 🎯 最佳實踐

1. **定期備份**
   - 編輯前先複製 `data/itinerary.json`
   - 使用 Git 版本控管（已設置）

2. **測試變更**
   - 在主網站上查看編輯效果
   - 確認格式和內容正確

3. **使用 Git 保護數據**
   ```bash
   git add .
   git commit -m "更新 Day X 行程"
   git push
   ```

4. **定期檢查**
   - 確保所有 8 天的行程都完整
   - 檢查文字格式和標點符號

---

## 📞 技術支援

如果遇到問題：
1. 檢查伺服器終端機的錯誤訊息
2. 查看瀏覽器開發者工具的 Console（按 F12）
3. 確認所有文件路徑正確
4. 驗證 JSON 文件格式（可使用 https://jsonlint.com/）

---

## 🔄 版本控管

記得在每次重要編輯後提交到 Git：

```bash
git add data/itinerary.json
git commit -m "更新行程：[描述您的變更]"
git push
```

這樣可以：
- 追蹤所有變更歷史
- 需要時回滾到之前的版本
- 保護數據不會意外丟失
